/* jce - 2.9.39 | 2023-07-25 | https://www.joomlacontenteditor.net | Copyright (C) 2006 - 2023 Ryan Demmer. All rights reserved | GNU/GPL Version 2 or later - http://www.gnu.org/licenses/gpl-2.0.html */
!function(){function isMedia(node){return node&&DOM.getParent(node,"[data-mce-object]")}function getAttribsFromHtml(html){var attribs={html:""},settings={verify_html:!0,validate:!0,forced_root_block:!1,invalid_elements:"script,noscript,svg"},parser=new DomParser(settings,htmlSchema);return parser.addNodeFilter("iframe",function(nodes){for(var node,i=nodes.length;i--;){node=nodes[i],each(node.attributes.map,function(val,name){attribs[name]=val});var child=node.firstChild;if(child&&htmlSchema.isValid(child.name))do child.value&&(attribs.html+=child.value);while(child=child.next)}}),parser.parse(html),attribs}function insertMedia(ed,data,provider){var node=ed.selection.getNode(),mediaApi=ed.plugins.media;if(data.html){var attribs=getAttribsFromHtml(data.html);data.width&&delete attribs.width,data.height&&delete attribs.height,extend(data,attribs)}if(data.query&&(data.src.indexOf("?")!==-1?data.src+="&"+data.query:data.src+="?"+data.query),isMedia(node))mediaApi.updateMedia(data);else{var html=mediaApi.getMediaHtml(data);ed.execCommand("insertMediaHtml",!1,html)}ed.undoManager.add(),ed.nodeChanged()}function getAttributes(ed,data){return data.style&&tinymce.is(data.style,"string")&&(data.style=ed.dom.parseStyle(data.style)),data.styles&&tinymce.is(data.styles,"object")&&(data.style=extend(data.styles,data.style||{})),data.style&&(data.style=ed.dom.serializeStyle(data.style)),data}var each=tinymce.each,extend=tinymce.extend,DOM=tinymce.DOM,htmlSchema=new tinymce.html.Schema,DomParser=tinymce.html.DomParser;tinymce.create("tinymce.plugins.IframePlugin",{init:function(ed,url){this.editor=ed,ed.addCommand("mceIframe",function(){ed.windowManager.open({file:ed.getParam("site_url")+"index.php?option=com_jce&task=plugin.display&plugin=iframe",size:"mce-modal-landscape-xlarge"},{plugin_url:url})}),ed.addButton("iframe",{title:"iframe.desc",cmd:"mceIframe"}),ed.onNodeChange.add(function(ed,cm,n,collapsed){n=ed.dom.getParent(n,".mce-object-iframe")||n;var state="iframe"===n.getAttribute("data-mce-object")||"IFRAME"===n.nodeName;cm.setDisabled("iframe",!state&&!collapsed),cm.setActive("iframe",state)})},createControl:function(n,cm){var ed=this.editor,mediaApi=ed.plugins.media;if("iframe"!==n)return null;var params=ed.getParam("iframe",{});if(params.quickmedia===!1)return cm.createButton("iframe",{title:"iframe.desc",cmd:"mceIframe"});var html='<div class="mceModalBody">\t<div class="mceModalContent">\t\t<div class="mceModalRow">   \t\t<div class="mceModalControl mceFlexAuto">       \t\t<textarea id="'+ed.id+'_iframe_input" aria-label="'+ed.getLang("media.embed_code","Embed Code")+'" placeholder="'+ed.getLang("media.embed_code","Embed Code")+'" rows="5"></textarea>   \t\t</div>\t\t</div>\t</div>\t<div class="mceModalFooter">\t\t<button id="'+ed.id+'_iframe_submit" class="mceButton mceButtonPrimary" type="button">'+ed.getLang("dlg.insert","Insert")+"</button>\t</div></div>",ctrl=cm.createSplitButton("iframe",{title:"iframe.desc",cmd:"mceIframe",max_width:264,onselect:function(node){""!==node.value&&(node&&isMedia(node)?mediaApi.updateMedia({src:node.value}):insertMedia(ed,{src:node.value}))}});return ctrl.onRenderMenu.add(function(c,m){var item=m.add({onclick:function(e){e.preventDefault(),item.setSelected(!1);var n=ed.dom.getParent(e.target,".mceButton");if(n&&!n.disabled){var value=DOM.getValue(ed.id+"_iframe_input")||"";value=value.trim(),value&&mediaApi.isMediaHtml(value)&&insertMedia(ed,{html:value,attributes:getAttributes(ed,params.attributes||{})}),m.hideMenu()}},html:html});m.onShowMenu.add(function(){var selection=ed.selection,data={},node=selection.getNode();node&&isMedia(node)&&(data=mediaApi.getMediaData());var btnLabel=ed.getLang("insert","Insert");window.setTimeout(function(){DOM.get(ed.id+"_iframe_input").focus()},10);var html="";data.src&&(html=mediaApi.getMediaHtml(data),btnLabel=ed.getLang("update","Update")),DOM.setValue(ed.id+"_iframe_input",html),DOM.get(ed.id+"_iframe_submit").innerText=btnLabel})}),ctrl}}),tinymce.PluginManager.add("iframe",tinymce.plugins.IframePlugin)}();